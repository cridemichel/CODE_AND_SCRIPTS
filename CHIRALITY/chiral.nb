(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    193644,       5194]
NotebookOptionsPosition[    185707,       4933]
NotebookOutlinePosition[    186095,       4950]
CellTagsIndexPosition[    186052,       4947]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"allAT1", "=."}]], "Input",
 CellChangeTimes->{{3.642783949865561*^9, 3.6427840346067753`*^9}, 
   3.64278410873006*^9, {3.6428211463500223`*^9, 3.642821175576674*^9}, 
   3.642821375946409*^9, {3.642826296848078*^9, 3.642826299160018*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.642833775551985*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"add", " ", "radius", " ", "to", " ", "structure"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.642820743783553*^9, 3.642820750772387*^9}}],

Cell[BoxData[{
 RowBox[{"allAT1", "=."}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAT1", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<allAT_1_PAS.pdb\>\"", ",", " ", "\"\<Table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "k", ",", "elem", ",", "rcm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "allAT1", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"elem", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"allAT1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[Equal]", " ", 
           "\"\<S\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elem", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "7"}], "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elem", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"elem", ",", "3.5"}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"allAT1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[Equal]", " ", 
           "\"\<P\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elem", "=", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "7"}], "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elem", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"elem", ",", "3.0"}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"allAT1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[Equal]", " ", 
           "\"\<B\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elem", "=", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"allAT1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "7"}], "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elem", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"elem", ",", "4.0"}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allAT1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "elem"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rcm", "=", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "allAT1", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"rcm", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
         RowBox[{
          RowBox[{"rcm", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rcm", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
         RowBox[{
          RowBox[{"rcm", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", " ", 
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rcm", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", " ", 
         RowBox[{
          RowBox[{"rcm", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", " ", 
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rcm", " ", "=", " ", 
      RowBox[{"rcm", "/", " ", 
       RowBox[{"Length", "[", "allAT1", "]"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "allAT1", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"allAT1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
          RowBox[{"rcm", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allAT1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "-", " ", 
          RowBox[{"rcm", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allAT1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "4"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"allAT1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "4"}], "]"}], "]"}], " ", "-", " ", 
          RowBox[{"rcm", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.64282073967476*^9, {3.6428207782038403`*^9, 3.642820818539186*^9}, {
   3.6428211202593613`*^9, 3.642821206361709*^9}, {3.642821245904948*^9, 
   3.642821423374722*^9}, {3.64282147862468*^9, 3.642821489673626*^9}, {
   3.642821547821699*^9, 3.642821556103022*^9}, {3.642825723504436*^9, 
   3.642825725478797*^9}, {3.642826162801045*^9, 3.642826192237002*^9}, {
   3.6428262232608557`*^9, 3.642826286329515*^9}, {3.642826316481184*^9, 
   3.642826396810527*^9}, {3.642833565235326*^9, 3.642833584673856*^9}, {
   3.642833646035914*^9, 3.642833649671052*^9}, {3.642833682255829*^9, 
   3.642833684741555*^9}, {3.642833719142906*^9, 3.6428337869757442`*^9}, {
   3.6428366877832613`*^9, 3.642836900431302*^9}, {3.642836936374577*^9, 
   3.642837149402731*^9}, {3.642837260724289*^9, 3.6428372689372673`*^9}, {
   3.642837395431731*^9, 3.642837439136938*^9}, {3.642837484487523*^9, 
   3.642837491562429*^9}, {3.6430058099454937`*^9, 3.643005829442419*^9}, {
   3.643005870788744*^9, 3.6430060411580677`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"allAT1", "[", 
   RowBox[{"[", "8", "]"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.642826435550806*^9, 3.642826443949039*^9}, {
  3.642833535447571*^9, 3.642833535544158*^9}, {3.642833600978706*^9, 
  3.642833601030487*^9}, {3.642833813821308*^9, 3.642833814185358*^9}, {
  3.642836702148031*^9, 3.6428367022609463`*^9}, {3.6428369263268547`*^9, 
  3.6428369266720533`*^9}, {3.642837023399033*^9, 3.6428370260207644`*^9}, {
  3.642837194167845*^9, 3.642837194201067*^9}, {3.642837244962122*^9, 
  3.642837251415682*^9}, {3.64283729916492*^9, 3.6428373877335443`*^9}, {
  3.642837446844685*^9, 3.642837452734973*^9}, {3.6428374963214617`*^9, 
  3.6428374992204*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "4.962`", ",", "4.971`", ",", "15.486`", ",", "3.5`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.642837388035668*^9, {3.642837440954504*^9, 3.642837453094864*^9}, {
   3.6428374945075207`*^9, 3.642837499498808*^9}, 3.643006053770853*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allAT1", "[", 
  RowBox[{"[", "8", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "4.685814285714286`", ",", "5.007242857142857`", ",", 
   "15.48567142857143`", ",", "3.5`"}], "}"}]], "Output",
 CellChangeTimes->{3.643006061969442*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistBox", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.000000", ",", "0.000000", ",", "0.000000"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.867664161274261"}], ",", "0.450255427952492", ",", 
       "0.210781765908607"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.497123852463982"}], ",", 
       RowBox[{"-", "0.781363192633727"}], ",", 
       RowBox[{"-", "0.377278990282521"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.00517479966781695"}], ",", 
       RowBox[{"-", "0.432136102167532"}], ",", "0.901793552123683"}], 
      "}"}]}], "}"}], "\n", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "16.425667"}], ",", 
     RowBox[{"-", "4.542812"}], ",", 
     RowBox[{"-", "28.395133"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.878150713638107"}], ",", 
       RowBox[{"-", "0.460129525789475"}], ",", "0.130889814858287"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.476594575369197", ",", 
       RowBox[{"-", "0.865125677111045"}], ",", "0.156253555261346"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0413392654208923", ",", "0.19959554679378", ",", 
       "0.979005966700179"}], "}"}]}], "}"}], "\n", ",", 
   RowBox[{"{", 
    RowBox[{"12.462578", ",", "12.402555", ",", "23.033728"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.642752335690974*^9, 3.642752383044609*^9}, {
  3.64275304963326*^9, 3.6427530539583387`*^9}, {3.642753178765122*^9, 
  3.64275319391714*^9}, {3.642753353377905*^9, 3.642753368310429*^9}, {
  3.642753440770026*^9, 3.642753441547536*^9}, {3.642768491085363*^9, 
  3.642768492140275*^9}, {3.642769371337612*^9, 3.6427693721200333`*^9}, {
  3.6427697038657637`*^9, 3.64276970460793*^9}, {3.6427838950740557`*^9, 
  3.6427838955450583`*^9}}],

Cell[BoxData[
 RowBox[{"-", "1.`"}]], "Output",
 CellChangeTimes->{
  3.6427523834493313`*^9, 3.642753194838366*^9, 3.642753286554081*^9, {
   3.64275335505369*^9, 3.642753368801694*^9}, 3.6427534422853518`*^9, 
   3.642754955769209*^9, 3.642755011477366*^9, {3.642755087337894*^9, 
   3.6427551071378117`*^9}, 3.6427555504699993`*^9, 3.642767407542428*^9, 
   3.6427683010644903`*^9, 3.642768348749213*^9, {3.642768492875978*^9, 
   3.642768495424492*^9}, 3.642768567324123*^9, {3.6427686870495*^9, 
   3.6427687776138773`*^9}, {3.642768820988282*^9, 3.642768837072398*^9}, 
   3.6427689720637217`*^9, 3.6427690303463707`*^9, 3.642769072329322*^9, 
   3.6427691240559607`*^9, {3.64276933827932*^9, 3.6427693726534*^9}, {
   3.642769682029854*^9, 3.642769705218253*^9}, 3.642783896060103*^9, 
   3.642826401340152*^9, 3.642850792165152*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistBox", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.000000", ",", "0.000000", ",", "0.000000"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.599763615049446", ",", 
       RowBox[{"-", "0.787473641042234"}], ",", "0.142017149409877"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "0.790838822864782", ",", "0.610389393301374", ",", 
       "0.044707323729185"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.12189160066496"}], ",", "0.0854988491669168", ",", 
       "0.988854076433154"}], "}"}]}], "}"}], "\n", ",", 
   RowBox[{"{", 
    RowBox[{"73.825372", ",", 
     RowBox[{"-", "31.010907"}], ",", 
     RowBox[{"-", "34.533108"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.608750692978627"}], ",", 
       RowBox[{"-", "0.726404894759498"}], ",", "0.318996117010043"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.609850474827783", ",", 
       RowBox[{"-", "0.685628365007899"}], ",", 
       RowBox[{"-", "0.397487287153845"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.507449497142691", ",", 
       RowBox[{"-", "0.0474307280783039"}], ",", "0.860375112310667"}], 
      "}"}]}], "}"}], "\n", ",", 
   RowBox[{"{", 
    RowBox[{"12.462578", ",", "12.402555", ",", "23.033728"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.642769718148378*^9, 3.642769720351508*^9}, {
  3.6427833204419603`*^9, 3.642783321215184*^9}, {3.642783938803933*^9, 
  3.642783939029839*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{
  3.642769720952232*^9, {3.6427833217698174`*^9, 3.642783412454606*^9}, {
   3.642783459608943*^9, 3.6427835042508183`*^9}, 3.642783537135742*^9, {
   3.642783583972824*^9, 3.642783649630541*^9}, 3.642783681233468*^9, 
   3.6427837339144506`*^9, 3.6427838632556267`*^9, 3.64278393956015*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DistBox", "=."}]], "Input",
 CellChangeTimes->{{3.642766797116355*^9, 3.642766810020505*^9}, 
   3.6427669985680857`*^9, {3.6427674605906277`*^9, 3.642767462075838*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DistBox", "[", 
     RowBox[{
     "pos1_", ",", "RM1_", ",", " ", "pos2_", ",", " ", "RM2_", ",", "sax_"}],
      "]"}], ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "RR", ",", "R0", ",", "R1", ",", " ", "cij", ",", " ", "fabscij", ",", 
      "R01", ",", " ", "DD", ",", " ", "AA", ",", " ", "BB", ",", " ", "EA", 
      ",", " ", "EB", ",", " ", "rA", ",", " ", "rB", ",", "k", ",", "k1", 
      ",", "k2", ",", 
      RowBox[{"existsParallelPair", "=", "0"}], ",", 
      RowBox[{"AD", "=", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DistBox", "[", 
     RowBox[{
     "pos1_", ",", "RM1_", ",", " ", "pos2_", ",", " ", "RM2_", ",", "sax_"}],
      "]"}], ":="}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DistBox", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos1", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"RM1", ",", "_Real", ",", "2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"pos2", ",", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"RM2", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"sax", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DistBox", "[", 
         RowBox[{
         "pos1_", ",", "RM1_", ",", " ", "pos2_", ",", " ", "RM2_", ",", 
          "sax_"}], "]"}], ":="}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RR", "=", "0.0"}], ",", "R0", ",", "R1", ",", " ", "cij", 
          ",", " ", "fabscij", ",", 
          RowBox[{"fabscijC", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
          RowBox[{"R01", "=", "0."}], ",", " ", 
          RowBox[{"DD", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
          RowBox[{"AA", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], ",", 
          " ", 
          RowBox[{"BB", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], ",", 
          " ", 
          RowBox[{"EA", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
          RowBox[{"EB", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
          RowBox[{"rA", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
          RowBox[{"rB", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k1", "=", "0"}], ",", 
          RowBox[{"k2", "=", "0"}], ",", 
          RowBox[{"existsParallelPair", "=", "0"}], ",", 
          RowBox[{"AD", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rA", "=", "pos1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"rB", "=", "pos2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"EA", "=", "sax"}], ";", "\[IndentingNewLine]", 
         RowBox[{"EB", "=", "sax"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"AA", "=", "RM1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BB", "=", "RM2"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"DD", "=", 
          RowBox[{"pos1", "-", "pos2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cij", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fabscij", "=", "cij"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cij", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AA", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ".", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fabscij", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"cij", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", " ", "<=", " ", "3"}], ",", " ", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fabscij", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "j"}], "]"}], "]"}], "\[Equal]", " ", "1"}],
              ",", " ", 
             RowBox[{"existsParallelPair", "=", "1"}]}], "]"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AD", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"AA", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", "DD"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RR", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"AD", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", "=", " ", 
          RowBox[{"EB", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{
           RowBox[{"EA", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "R1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cij", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "=", "  ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AA", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ".", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fabscij", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"cij", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", " ", "<=", " ", "3"}], ",", " ", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fabscij", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j"}], "]"}], "]"}], "\[Equal]", " ", "1"}],
              ",", " ", 
             RowBox[{"existsParallelPair", "=", "1"}]}], "]"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AD", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"AA", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", "DD"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RR", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"AD", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", "=", " ", 
          RowBox[{"EB", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{
           RowBox[{"EA", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "R1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cij", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "=", "  ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AA", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ".", 
             RowBox[{"BB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fabscij", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"cij", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", " ", "<=", " ", "3"}], ",", " ", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fabscij", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "j"}], "]"}], "]"}], "\[Equal]", " ", "1"}],
              ",", " ", 
             RowBox[{"existsParallelPair", "=", "1"}]}], "]"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AD", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"AA", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ".", "DD"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RR", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"AD", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", "=", " ", 
          RowBox[{"EB", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{
           RowBox[{"EA", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "+", "R1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RR", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"BB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ".", "DD"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"fabscijC", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"fabscij", " ", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{"EA", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", 
           RowBox[{"EB", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<qui RR=\>\"", ",", " ", "RR", ",", " ", "\"\< R01=\>\"", ",",
              "R01", ",", " ", "\"\< cij[[2]]=\>\"", ",", " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", "\"\< \>\"", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AA", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"BB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", " ", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"BB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ".", "DD"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{"EA", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", 
           RowBox[{"EB", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"BB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ".", "DD"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{"EA", ".", 
           RowBox[{"fabscij", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", 
           RowBox[{"EB", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"existsParallelPair", "  ", "\[Equal]", " ", "1"}], ",", 
           " ", 
           RowBox[{"Return", "[", 
            RowBox[{"-", "1.0"}], "]"}]}], " ", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", "+", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], " ", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", "+", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", "+", "R1"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", " ", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], " ", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "3", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RR", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"AD", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"cij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R0", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"EB", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"fabscij", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R01", " ", "=", " ", 
          RowBox[{"R0", " ", "+", " ", "R1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"RR", " ", ">", " ", "R01"}], ",", " ", 
           RowBox[{"Return", "[", "1.0", "]"}]}], "]"}], ";", " \t", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"-", "1.0"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"-", "1.0"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.642680674086431*^9, 3.6426807521614*^9}, {
   3.642680862279737*^9, 3.642680912479815*^9}, {3.642681001877615*^9, 
   3.642681413171455*^9}, 3.642681444195799*^9, {3.642733666360241*^9, 
   3.6427337146606073`*^9}, {3.642733989848473*^9, 3.642733997998845*^9}, {
   3.642734259920684*^9, 3.64273426119564*^9}, {3.642734373709641*^9, 
   3.642734647377285*^9}, {3.642734681194105*^9, 3.642734752484901*^9}, {
   3.642734787398786*^9, 3.6427349156815*^9}, {3.642735053094615*^9, 
   3.642735060805127*^9}, {3.642743448793468*^9, 3.6427435781933317`*^9}, {
   3.642743614949298*^9, 3.642744937688555*^9}, {3.642745003109721*^9, 
   3.6427450058201036`*^9}, {3.642752327495102*^9, 3.642752329586158*^9}, {
   3.642753280666751*^9, 3.6427532808442373`*^9}, {3.642754949501246*^9, 
   3.642754951939618*^9}, {3.642754988952919*^9, 3.642755094634733*^9}, {
   3.642755132110415*^9, 3.642755205932026*^9}, {3.6427552431790648`*^9, 
   3.642755274483292*^9}, {3.642755352692409*^9, 3.642755403631871*^9}, {
   3.6427555270196323`*^9, 3.64275554763794*^9}, {3.642765950424499*^9, 
   3.642765950909575*^9}, {3.64276598784319*^9, 3.642765991267712*^9}, {
   3.642766777316299*^9, 3.6427667917204943`*^9}, {3.6427668404023533`*^9, 
   3.6427668546270742`*^9}, {3.6427670020938473`*^9, 3.642767057889635*^9}, {
   3.642767099717249*^9, 3.6427671309550343`*^9}, {3.6427672971926203`*^9, 
   3.642767351155003*^9}, {3.642767422342266*^9, 3.642767448975553*^9}, 
   3.642767479860593*^9, {3.642767943642413*^9, 3.642767995664486*^9}, {
   3.642768060268775*^9, 3.642768137371848*^9}, {3.642768167804205*^9, 
   3.6427681728287363`*^9}, {3.6427682465570593`*^9, 3.642768261404175*^9}, {
   3.64276832831531*^9, 3.6427683424962254`*^9}, {3.642768678133884*^9, 
   3.642768967775887*^9}, {3.6427690131001863`*^9, 3.642769061576672*^9}, {
   3.642769098555522*^9, 3.642769119235116*^9}, {3.6427692898777237`*^9, 
   3.642769291167625*^9}, 3.642769764366541*^9, {3.642783339925565*^9, 
   3.642783408914735*^9}, {3.642783455266389*^9, 3.6427834789779882`*^9}, {
   3.642783515845035*^9, 3.642783677430026*^9}, {3.642783724954832*^9, 
   3.64278384713336*^9}, {3.642784240966311*^9, 3.6427842413137913`*^9}, {
   3.6430186959864893`*^9, 3.643018704100601*^9}, {3.643018867827691*^9, 
   3.643018868093815*^9}, {3.643018973761599*^9, 3.643018974677042*^9}, {
   3.643019046599031*^9, 3.643019056238873*^9}, {3.643019098407405*^9, 
   3.6430190989668283`*^9}, 3.6430192794970207`*^9, 3.643021116390613*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anglestoR", "=."}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"(*", 
  RowBox[{
   RowBox[{" ", 
    RowBox[{"angles", "=", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Gamma]"}]}]}], ")"}], " ", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.642733868283834*^9, 3.642733869056157*^9}, {
  3.642832490109367*^9, 3.642832494520341*^9}, {3.643019302998266*^9, 
  3.643019323518251*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglestoR", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"angles", ",", "_Real", ",", " ", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"RotFunc", ",", 
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"j", "=", "0"}], ",", 
         RowBox[{"u", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", "R", ",", 
         RowBox[{"uu", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"angles", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"angles", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"angles", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"angles", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{"Cos", "[", 
          RowBox[{"angles", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", "u"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uu", " ", "=", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"uu", "\[Equal]", "u"}], ",", " ", 
          RowBox[{"uu", "=", 
           RowBox[{"{", 
            RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uu", " ", "=", " ", 
         RowBox[{"uu", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"uu", ".", "u"}], ")"}], " ", "u"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"uu", "/", 
          RowBox[{"Norm", "[", "uu", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{"R", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"add", " ", "rotation", " ", "around", " ", "z"}], "-", 
          "axis"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "R"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.64283148442025*^9, 3.642831517539019*^9}, {
   3.6428317178667316`*^9, 3.642831719664027*^9}, {3.6428320848885612`*^9, 
   3.642832096997473*^9}, {3.642832140797092*^9, 3.642832304274879*^9}, {
   3.642832396561615*^9, 3.642832398432165*^9}, {3.642832429940756*^9, 
   3.642832432852099*^9}, {3.642832510632786*^9, 3.642832782797552*^9}, {
   3.642832896676866*^9, 3.64283299129033*^9}, {3.6428330799531393`*^9, 
   3.642833125232863*^9}, {3.642833183590989*^9, 3.64283321165237*^9}, {
   3.6428332436228313`*^9, 3.6428332445629463`*^9}, 3.642849720735446*^9, {
   3.643459327707521*^9, 3.643459330736065*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"anglestoRSym", "[", "angles_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RotFunc", ",", 
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"j", "=", "0"}], ",", 
       RowBox[{"u", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "R", ",", 
       RowBox[{"uu", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"angles", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"angles", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"angles", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"angles", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"Cos", "[", 
        RowBox[{"angles", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "u"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uu", " ", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"uu", "\[Equal]", "u"}], ",", " ", 
        RowBox[{"uu", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uu", " ", "=", " ", 
       RowBox[{"uu", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"uu", ".", "u"}], ")"}], " ", "u"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"uu", "/", 
        RowBox[{"Norm", "[", "uu", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"R", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"add", " ", "rotation", " ", "around", " ", "z"}], "-", 
        "axis"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "R"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643459337001124*^9, 3.643459368056327*^9}, {
  3.643459436599992*^9, 3.643459454453519*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anglestoR", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.642832389399474*^9, 3.642832443219462*^9}, {
  3.642832954149057*^9, 3.6428329557119827`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6428346006594143`*^9, 3.642849723071198*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allAT1", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.642837178844996*^9, 3.642837181855934*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   RowBox[{"-", "0.228`"}], ",", "2.834`", ",", "18.443`", ",", "4.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.642837182143297*^9, {3.642837507237494*^9, 3.642837524741809*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Omega", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", " ", 
       RowBox[{"-", "oz"}], ",", "oy"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"oz", ",", "0.", ",", 
       RowBox[{"-", "ox"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "oz"}], ",", "oy", ",", "0."}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.64283993243719*^9, 3.642839952351286*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addrotation", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"angle", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ov", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"R", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"thetaSq", "=", "0.0"}], ",", " ", "Omega", ",", "OmegaSq", 
         ",", " ", "M", ",", "sinw", ",", "cosw", ",", "Ro"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thetaSq", "=", 
         RowBox[{"angle", " ", "angle"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sinw", "=", " ", 
         RowBox[{"Sin", "[", "angle", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cosw", "=", 
         RowBox[{"1.", "-", 
          RowBox[{"Cos", "[", "angle", "]"}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Omega", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", " ", 
             RowBox[{"-", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"ov", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ov", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "0.", ",", 
             RowBox[{"-", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"ov", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0."}], "}"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"OmegaSq", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"ov", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], " ", 
               RowBox[{"ov", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"ov", "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", 
               RowBox[{"ov", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"ov", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"ov", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], 
               RowBox[{"ov", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"ov", "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", 
               RowBox[{"ov", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"ov", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{"ov", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ov", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"ov", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"ov", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], 
               RowBox[{"ov", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"ov", "[", 
                RowBox[{"[", "2", "]"}], "]"}], 
               RowBox[{"ov", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sinw"}], " ", "Omega"}], " ", "+", " ", 
          RowBox[{"cosw", " ", "OmegaSq"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"R", "+", 
         RowBox[{"R", ".", "M"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.642839471258029*^9, 3.642839674034346*^9}, {
  3.6428397124991617`*^9, 3.642839798450939*^9}, {3.6428398341726513`*^9, 
  3.642839888675653*^9}, {3.642840060908239*^9, 3.642840114036786*^9}, {
  3.642840150702385*^9, 3.642840161850417*^9}, {3.642840203198032*^9, 
  3.6428402074685373`*^9}, {3.642840253346191*^9, 3.642840408238298*^9}, {
  3.642840566180822*^9, 3.642840604945963*^9}, {3.642840647012561*^9, 
  3.642840650646907*^9}, {3.643019524094109*^9, 3.643019524254146*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"addrotation", "[", 
  RowBox[{
   RowBox[{"Pi", "/", "2"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642840447594214*^9, 3.642840467694764*^9}, {
  3.642840499668578*^9, 3.642840510949765*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.1102230246251565`*^-16", ",", "1.`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "1.`"}], ",", "1.1102230246251565`*^-16"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.642840468065041*^9, 3.6428405112169437`*^9, {3.642840568446103*^9, 
   3.6428405760763617`*^9}, 3.642840606093732*^9, 3.6428406521260633`*^9, 
   3.642849729496006*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allAT1", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.643019696121207*^9, 3.643019700955666*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   RowBox[{"-", "0.5041857142857141`"}], ",", "2.8702428571428573`", ",", 
   "18.442671428571433`", ",", "4.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.643019697488879*^9, 3.643019701226259*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.643019611839654*^9, 3.643019612579296*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverlapFunc", "=", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"R1", ",", "_Real", ",", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"r2", ",", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"R2", ",", "_Real", ",", " ", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"N", ",", " ", "_Integer", ",", " ", "0"}], "}"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "overlap", ",", "RF1", ",", " ", "RF2", ",", 
         RowBox[{"rad", "=", "0."}], ",", " ", 
         RowBox[{"radsq", "=", "0."}], ",", 
         RowBox[{"distsq", "=", "0."}], ",", 
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"j", "=", "0"}], ",", 
         RowBox[{"k", "=", "0"}], ",", 
         RowBox[{"xp1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
         RowBox[{"xp2", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
         RowBox[{"x1", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
         RowBox[{"x2", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
         RowBox[{"deltx", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", 
         RowBox[{"x1t", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", " ", 
         RowBox[{"x2t", "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"RF1", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"angles1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"R1", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RF2", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"angles2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"R2", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"overlap", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", " ", "<=", " ", "N"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", " ", 
             RowBox[{"j", " ", "<=", " ", "N"}], ",", " ", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rad", "=", " ", 
               RowBox[{
                RowBox[{"allAT1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "5"}], "]"}], "]"}], "+", 
                RowBox[{"allAT1", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "5"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"radsq", "=", 
               RowBox[{"rad", " ", "rad"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"xp1", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"allAT1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"xp2", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"allAT1", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"x1", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "R1", "]"}], ".", "xp1"}], "+", 
                "r1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"x2", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "R2", "]"}], ".", "xp2"}], "+", 
                "r2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"deltx", "=", 
               RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"distsq", "=", 
               RowBox[{"deltx", ".", "deltx"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"If", " ", "[", 
               RowBox[{
                RowBox[{"distsq", " ", "<", " ", "radsq"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"overlap", "=", "1"}], ";", " ", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{"overlap", "\[Equal]", "1"}], ",", " ", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"overlap", "\[Equal]", "1"}], ",", 
          RowBox[{"res", "=", " ", 
           RowBox[{"-", "1.0"}]}], ",", 
          RowBox[{"res", "=", " ", "1.0"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0VkowwEcB/B/q2HleKCV62HOjdmy3GeiRupvbjlyHxkJZSEpw4OoleQc
K9dsmniQDSvzosy1UMz55BxReODB//t/+PXp1/f79PtxKpqyqhkEQfhTA8c4
zHfC7yWJdHamHUoZ5dlTflQraQcfNUKoJX1iIBl5TLpQ9pylZkCzJfHKl1Jd
kn0PX2drHQIo4y7cWfCKx3KBmoYBT9if58aHU6s7JOQqJnPgWm9zCWR/iyrp
/ElN+8cQSmF5o1MfNPVPrsPu6/RtmC/NFwRSjuw5iqFGMCCDioTOdsjMnO+B
bfooObQMDSvgRg1PBeutz3PQ3vS5ALusrVrYKBYboer2YB8uMyrMkNNWdw47
5lwv6VwSeAdbxmdoQ9hyLRd928sKtMSqDZBIV27BvYUiExT8ME+gz+5vMo+y
mBssgbKvgAK4bmwog3GqVm4Qdt0bH242H4qgYTosHObZOGK445mWCt0kH/Xw
yJwrhY5yW7AQf5R58CErSxoKH70dREL6vtYoaHh1jYZ2Gnk7PCwN64CFP/ET
sOrmSQl1Xu5L8DSC1EH+w6Iesuv0BvgPRxn8NQ==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"OverlapFunc", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.000000", ",", "0.000000", ",", "0.000000"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.867664161274261"}], ",", "0.450255427952492", ",", 
        "0.210781765908607"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.497123852463982"}], ",", 
        RowBox[{"-", "0.781363192633727"}], ",", 
        RowBox[{"-", "0.377278990282521"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.00517479966781695"}], ",", 
        RowBox[{"-", "0.432136102167532"}], ",", "0.901793552123683"}], 
       "}"}]}], "}"}], "\n", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "16.425667"}], ",", 
      RowBox[{"-", "4.542812"}], ",", 
      RowBox[{"-", "28.395133"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.878150713638107"}], ",", 
        RowBox[{"-", "0.460129525789475"}], ",", "0.130889814858287"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0.476594575369197", ",", 
        RowBox[{"-", "0.865125677111045"}], ",", "0.156253555261346"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0413392654208923", ",", "0.19959554679378", ",", 
        "0.979005966700179"}], "}"}]}], "}"}], ",", "70"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.64283443217095*^9, 3.642834467199462*^9}, {
   3.642834652676752*^9, 3.6428346627520037`*^9}, {3.6428375896002407`*^9, 
   3.642837594895629*^9}, {3.642837778827034*^9, 3.642837793140539*^9}, {
   3.64283991145359*^9, 3.642839912271052*^9}, {3.6428404226273518`*^9, 
   3.642840428846869*^9}, 3.642840663018079*^9, {3.642849666234977*^9, 
   3.642849666493869*^9}, {3.642850721499161*^9, 3.6428507467967243`*^9}, {
   3.6428508050099363`*^9, 3.642850849547776*^9}}],

Cell[BoxData[
 RowBox[{"-", "1.`"}]], "Output",
 CellChangeTimes->{
  3.642849739238097*^9, 3.642850679931327*^9, {3.642850778679677*^9, 
   3.6428508068995132`*^9}, 3.642850850546195*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LenAllAT", "=", 
  RowBox[{"Length", "[", "allAT1", "]"}]}]], "Input",
 CellChangeTimes->{{3.642784741840054*^9, 3.6427847494307947`*^9}, {
  3.642956145452094*^9, 3.642956146385995*^9}}],

Cell[BoxData["70"], "Output",
 CellChangeTimes->{3.64282646000668*^9, 3.642956146668832*^9, 
  3.642956810558202*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allAT1", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.642784891606292*^9, 3.6427849081061983`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   RowBox[{"-", "0.228`"}], ",", "2.834`", ",", "18.443`", ",", "4.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.642784908324297*^9, 3.642826422064221*^9, 
  3.642826452586185*^9, 3.642837513117977*^9, 3.6428499466614313`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"calcSax", "[", "pdb_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"maxX", "=", "0."}], ",", " ", 
       RowBox[{"maxY", "=", "0."}], ",", " ", 
       RowBox[{"maxZ", "=", "0."}], ",", " ", 
       RowBox[{"distx", "=", "0."}], ",", " ", 
       RowBox[{"disty", "=", "0."}], ",", " ", 
       RowBox[{"distz", "=", "0."}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "<=", " ", 
         RowBox[{"Length", "[", "pdb", "]"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"distx", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"disty", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";", "\t", 
         "\[IndentingNewLine]", 
         RowBox[{"distz", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "4"}], "]"}], "]"}], "+", 
            RowBox[{"pdb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
            RowBox[{"distx", " ", ">", " ", "maxX"}]}], ",", " ", 
           RowBox[{"maxX", "=", "distx"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
            RowBox[{"disty", " ", ">", " ", "maxY"}]}], ",", " ", 
           RowBox[{"maxY", "=", " ", "disty"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
            RowBox[{"distz", " ", ">", " ", "maxZ"}]}], ",", " ", 
           RowBox[{"maxZ", "=", " ", "distz"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"maxX", ",", "maxY", ",", "maxZ"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6427847780070963`*^9, 3.6427848026060266`*^9}, {
  3.642784847185081*^9, 3.6427848855097322`*^9}, {3.642784916668824*^9, 
  3.6427849556367483`*^9}, {3.6427849904598*^9, 3.642785130556375*^9}, {
  3.642849901547579*^9, 3.642849933222073*^9}, {3.6428499766927977`*^9, 
  3.642850128984522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SAXALLAT", "=", 
  RowBox[{"calcSax", "[", "allAT1", "]"}]}]], "Input",
 CellChangeTimes->{{3.642849908763548*^9, 3.642849940872099*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12.037814285714285`", ",", "12.146242857142857`", ",", 
   "22.805671428571433`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.642849995783758*^9, 3.642850028130735*^9, {3.642850065887965*^9, 
   3.642850075512125*^9}, {3.6428501083465023`*^9, 3.642850130795738*^9}, 
   3.642956150674707*^9, 3.642956813702196*^9, 3.642994661442196*^9, 
   3.643006100959428*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["SAXALLAT"], "Input",
 CellChangeTimes->{{3.6428499884549923`*^9, 3.642849990135798*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12.314`", ",", "12.11`", ",", "22.806`"}], "}"}]], "Output",
 CellChangeTimes->{3.6429946635387917`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fons", "[", 
    RowBox[{"x_", ",", "\[Alpha]_"}], "]"}], " ", ":=", 
   RowBox[{
    FractionBox["\[Alpha]", 
     RowBox[{"4", " ", "\[Pi]", " ", 
      RowBox[{"Sinh", "[", "\[Alpha]", "]"}]}]], 
    RowBox[{"Cosh", "[", 
     RowBox[{"\[Alpha]", " ", "x"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfons", "[", 
    RowBox[{"x_", ",", "\[Alpha]_"}], "]"}], ":=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Alpha]", "2"], " ", 
     RowBox[{"Csch", "[", "\[Alpha]", "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"x", " ", "\[Alpha]"}], "]"}]}], 
    RowBox[{"4", " ", "\[Pi]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{"angles", "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Gamma]"}]}]}], ")"}], "}"}],
    " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.642784555004545*^9, 3.642784603163603*^9}, {
  3.642851520859682*^9, 3.642851567130453*^9}, {3.642851609056614*^9, 
  3.6428516098180447`*^9}, {3.6430199132937107`*^9, 3.6430199268789997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegrandoV1", "=", " ", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angles1", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos2", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"angles2", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"alpha", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pos1", "=", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], ",", "R1", ",", 
          " ", "R2", ",", "u1", ",", "u2"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R1", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R2", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", "=", 
          RowBox[{"anglestoR", "[", "angles1", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R2", "=", 
          RowBox[{"anglestoR", "[", "angles2", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R1", "=", 
          RowBox[{"addrotation", "[", 
           RowBox[{
            RowBox[{"angles1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"R1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "R1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"R2", "=", 
          RowBox[{"addrotation", "[", 
           RowBox[{
            RowBox[{"angles2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"R2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "R2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u1", "=", 
          RowBox[{"R1", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2", "=", 
          RowBox[{"R2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DistBox", "[", 
             RowBox[{
             "pos1", ",", "R1", ",", " ", "pos2", ",", " ", "R2", ",", " ", 
              "SAXALLAT"}], "]"}], "<", " ", "0.0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OverlapFunc", "[", 
               RowBox[{
               "pos1", ",", "R1", ",", " ", "pos2", ",", " ", "R2", ",", " ", 
                "LenAllAT"}], "]"}], "<", " ", "0.0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"u1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{"pos2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"fons", "[", 
                 RowBox[{
                  RowBox[{"u1", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", "alpha"}], "]"}], " ", 
                RowBox[{"dfons", "[", 
                 RowBox[{
                  RowBox[{"u2", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", "alpha"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"angles1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"angles2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "0.0"}]}], "\[IndentingNewLine]", "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6427842545445223`*^9, 3.642784363411085*^9}, {
   3.642784423860279*^9, 3.642784480706193*^9}, {3.642784511907929*^9, 
   3.642784551345808*^9}, {3.642784636627975*^9, 3.642784638416917*^9}, {
   3.642784734594224*^9, 3.642784769825171*^9}, {3.6428497679292316`*^9, 
   3.6428498965254803`*^9}, {3.642850137468603*^9, 3.64285016707806*^9}, {
   3.642850264222163*^9, 3.642850342026842*^9}, {3.642850405173437*^9, 
   3.6428504473380623`*^9}, {3.6428507576273813`*^9, 3.642850758155711*^9}, 
   3.642850872940517*^9, {3.6428510719967003`*^9, 3.64285107325424*^9}, {
   3.6428511100726357`*^9, 3.642851115385497*^9}, 3.642851261440876*^9, {
   3.642851307940764*^9, 3.642851322028206*^9}, {3.642851386150627*^9, 
   3.642851437407092*^9}, 3.642851481152817*^9, {3.642851538142652*^9, 
   3.64285158146424*^9}, {3.643019794402937*^9, 3.643019846484111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ALPHA", "=", "30"}], ";"}]], "Input",
 CellChangeTimes->{{3.642855365499969*^9, 3.642855367660945*^9}, {
  3.6430008383383617`*^9, 3.6430008386283693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegrandoV1Int", "[", 
    RowBox[{
     RowBox[{"theta1_", "?", "NumericQ"}], ",", 
     RowBox[{"phi1_", "?", "NumericQ"}], ",", 
     RowBox[{"gamma1_", "?", "NumericQ"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"rx_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"ry_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"rz_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"theta2_", "?", "NumericQ"}], ",", 
     RowBox[{"phi2_", "?", "NumericQ"}], ",", 
     RowBox[{"gamma2_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"IntegrandoV1", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theta1", ",", "phi1", ",", "gamma1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"theta2", ",", "phi2", ",", "gamma2"}], "}"}], ",", "ALPHA"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.642855255142866*^9, 3.642855408443791*^9}, {
  3.64285546790191*^9, 3.642855496239196*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SAXALLAT", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.642853431877571*^9, 3.6428534332603703`*^9}, {
  3.6430056767779083`*^9, 3.643005679848467*^9}, {3.643025027994441*^9, 
  3.6430250282245693`*^9}}],

Cell[BoxData["12.037814285714285`"], "Output",
 CellChangeTimes->{
  3.64285126643157*^9, 3.642853433584341*^9, 3.642994667008231*^9, {
   3.643005677631864*^9, 3.643005680154798*^9}, 3.643025028508484*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "  ", "<", "100000"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"IntegrandoV1Int", "[", 
    RowBox[{
    "0.1", ",", "3", ",", "0.2", ",", "0", ",", "0", ",", "0.", ",", "0.2", 
     ",", "0.2", ",", "0.2"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642851226290753*^9, 3.642851240899232*^9}, {
  3.642851285456111*^9, 3.642851293133729*^9}, {3.642851591510722*^9, 
  3.6428516383306637`*^9}, {3.64285324875301*^9, 3.642853259177128*^9}, {
  3.642854562394899*^9, 3.642854661241906*^9}, {3.642854751259862*^9, 
  3.642854767379734*^9}, {3.6428554466116543`*^9, 3.64285545517745*^9}, {
  3.6428688730269737`*^9, 3.642868896411564*^9}, {3.642868943061614*^9, 
  3.642868943370378*^9}, {3.6430249053250427`*^9, 3.6430249064880733`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.643024908928101*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"500000", "/", "3600."}]], "Input",
 CellChangeTimes->{{3.642854669509207*^9, 3.642854689935186*^9}}],

Cell[BoxData["138.88888888888889`"], "Output",
 CellChangeTimes->{{3.6428546884819307`*^9, 3.642854690307138*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegrandoV1Int", "[", 
  RowBox[{
  "0.3", ",", "2", ",", "0.7", ",", "0", ",", "0.1", ",", "0", ",", "0.5", 
   ",", "0.8", ",", "0.2"}], "]"}]], "Input",
 CellChangeTimes->{{3.643024912456957*^9, 3.643025011384452*^9}, {
  3.643025058932179*^9, 3.6430251328829823`*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.013992901926102084`"}]], "Output",
 CellChangeTimes->{{3.6430250798506107`*^9, 3.64302513352096*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sinc", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"x", ",", "_Real"}], "}"}], "}"}], ",", 
    RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642854982986883*^9, 3.642855004129896*^9}, {
  3.6428550453550386`*^9, 3.642855047089028*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["CompiledFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False}, 
    PanelBox[
     PaneSelectorBox[{False->GridBox[{
        {
         PaneBox[
          ButtonBox[
           
           DynamicBox[FEPrivate`FrontEndResource[
            "FEBitmaps", "SquarePlusIconMedium"],
            ImageSizeCache->{15., {0., 15.}}],
           Appearance->None,
           ButtonFunction:>(Typeset`open$$ = True),
           Evaluator->Automatic,
           Method->"Preemptive"],
          Alignment->{Center, Center},
          
          ImageSize->
           Dynamic[{
            Automatic, 
             3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
              Magnification])}]], 
         GraphicsBox[
          {Thickness[0.038461538461538464`], 
           {FaceForm[{GrayLevel[0.93], Opacity[1.]}], 
            FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
             3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{25.499999999999996`,
              2.5}, {25.499999999999996`, 1.3953100000000003`}, {
             24.604699999999998`, 0.49999999999999994`}, {23.5, 
             0.49999999999999994`}, {2.5, 0.49999999999999994`}, {
             1.3953100000000003`, 0.49999999999999994`}, {
             0.49999999999999994`, 1.3953100000000003`}, {
             0.49999999999999994`, 2.5}, {0.49999999999999994`, 23.5}, {
             0.49999999999999994`, 24.604699999999998`}, {1.3953100000000003`,
              25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
             25.499999999999996`}, {24.604699999999998`, 
             25.499999999999996`}, {25.499999999999996`, 
             24.604699999999998`}, {25.499999999999996`, 23.5}, {
             25.499999999999996`, 2.5}}}]}, 
           {FaceForm[{RGBColor[0.5, 0.5, 0.5], Opacity[1.]}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
             19.116799999999998`}, {16.3832, 21.876199999999997`}, {16.3832, 
             20.021499999999996`}, {6.930469999999999, 20.021499999999996`}, {
             6.930469999999999, 18.212100000000003`}, {16.3832, 
             18.212100000000003`}, {16.3832, 16.357399999999995`}, {20.5426, 
             19.116799999999998`}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {9.46445, 
             11.079700000000003`}, {9.46445, 12.933999999999997`}, {
             18.917199999999998`, 12.933999999999997`}, {18.917199999999998`, 
             14.7438}, {9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 
             13.8391}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
              1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
             0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIRIGYC4r9qIkoPPog5zJd34+ifoeBwf6HGBfU8aYe0
2dKXhaMEHT77F2xc1CQH52elHtL/aqrg0KrArnpmjpRDvTCXYEG9gsOOYKuI
/6tlHZ5WFpRfO4qQn3ww8NOrXYpw/fNmfE3SCFCG8z8EiLwQ7lSF2w82/44y
nM937b/lmXNKDnK7FuxLZZFwMDfq/3NwgpKDccaL+Q9miDok9Mnt3x6k5FDt
mbylT0ECwk9QhOuXWfO/eIajPCq/WNYh5kh50jV+CYc1eV/nfGGShZsXte2a
OGevDNy8ZqG0W/9KpeD60cMLAIwUgfU=
             "]], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{12.82453, 5.289294374999999}, {
             11.960858124999998`, 8.29796625}, {11.080858124999999`, 
             8.29796625}, {12.417186249999999`, 4.337966249999999}, {
             13.193201874999998`, 4.337966249999999}, {14.540701874999998`, 
             8.29796625}, {13.688201874999999`, 8.29796625}, {12.82453, 
             5.289294374999999}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
              3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
             0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIpIGYC4qwFP+fsFjB0WFcz7fnBvSIOLFaTza6GGTjM
l3fj6J+h4GC9PHLBXXc9DH7abOnLwlGCDtPNZKaxndfH4Is8/uOrISAD53uI
GTRGxyP4O4KtIv6fR/BbFdhVz8TIOqj9FNyfdEbfIejt5Y8zXiL4h7TunbCJ
koPzweYvkXP4mfT+6PSlBnD7n25Z/mROiSGcr7S/rqPX1AiuHsaHmQfjw+zz
lubzZjYxgrsHxoe5F8aH+QfGn/B91VROQQQfZr/Ei1viF75j8mHh6eiSdevo
cUM4Hz0+AG0eosQ=
             "]]}},
          AspectRatio->1,
          Axes->False,
          Background->GrayLevel[0.93],
          Frame->True,
          FrameStyle->Directive[
            Thickness[Tiny], 
            GrayLevel[0.7]],
          FrameTicks->None,
          ImageSize->{Automatic, 
            Dynamic[
            3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
              Magnification]), ImageSizeCache -> {45., {0., 9.}}]}], 
         GridBox[{
           {
            RowBox[{
             TagBox["\<\"Argument count: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox["1",
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Argument types: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              StyleBox[
               PaneBox[
                RowBox[{"{", "_Real", "}"}],
                BaselinePosition->Baseline,
                ContentPadding->False,
                FrameMargins->0,
                ImageSize->{{1, 300}, Automatic},
                ScrollPosition->{0., 0.},
                StripOnInput->True],
               LineBreakWithin->False],
              "SummaryItem"]}]}
          },
          AutoDelete->False,
          
          BaseStyle->{
           ShowStringCharacters -> False, NumberMarks -> False, 
            PrintPrecision -> 3, ShowSyntaxStyles -> False},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}
       },
       AutoDelete->False,
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Rows" -> {{Top}}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True->
      GridBox[{
        {
         PaneBox[
          ButtonBox[
           
           DynamicBox[FEPrivate`FrontEndResource[
            "FEBitmaps", "SquareMinusIconMedium"]],
           Appearance->None,
           ButtonFunction:>(Typeset`open$$ = False),
           Evaluator->Automatic,
           Method->"Preemptive"],
          Alignment->{Center, Center},
          
          ImageSize->
           Dynamic[{
            Automatic, 
             3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
              Magnification])}]], 
         GraphicsBox[
          {Thickness[0.038461538461538464`], 
           {FaceForm[{GrayLevel[0.93], Opacity[1.]}], 
            FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
             3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{25.499999999999996`,
              2.5}, {25.499999999999996`, 1.3953100000000003`}, {
             24.604699999999998`, 0.49999999999999994`}, {23.5, 
             0.49999999999999994`}, {2.5, 0.49999999999999994`}, {
             1.3953100000000003`, 0.49999999999999994`}, {
             0.49999999999999994`, 1.3953100000000003`}, {
             0.49999999999999994`, 2.5}, {0.49999999999999994`, 23.5}, {
             0.49999999999999994`, 24.604699999999998`}, {1.3953100000000003`,
              25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
             25.499999999999996`}, {24.604699999999998`, 
             25.499999999999996`}, {25.499999999999996`, 
             24.604699999999998`}, {25.499999999999996`, 23.5}, {
             25.499999999999996`, 2.5}}}]}, 
           {FaceForm[{RGBColor[0.5, 0.5, 0.5], Opacity[1.]}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
             19.116799999999998`}, {16.3832, 21.876199999999997`}, {16.3832, 
             20.021499999999996`}, {6.930469999999999, 20.021499999999996`}, {
             6.930469999999999, 18.212100000000003`}, {16.3832, 
             18.212100000000003`}, {16.3832, 16.357399999999995`}, {20.5426, 
             19.116799999999998`}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {9.46445, 
             11.079700000000003`}, {9.46445, 12.933999999999997`}, {
             18.917199999999998`, 12.933999999999997`}, {18.917199999999998`, 
             14.7438}, {9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 
             13.8391}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
              1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
             0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIRIGYC4r9qIkoPPog5zJd34+ifoeBwf6HGBfU8aYe0
2dKXhaMEHT77F2xc1CQH52elHtL/aqrg0KrArnpmjpRDvTCXYEG9gsOOYKuI
/6tlHZ5WFpRfO4qQn3ww8NOrXYpw/fNmfE3SCFCG8z8EiLwQ7lSF2w82/44y
nM937b/lmXNKDnK7FuxLZZFwMDfq/3NwgpKDccaL+Q9miDok9Mnt3x6k5FDt
mbylT0ECwk9QhOuXWfO/eIajPCq/WNYh5kh50jV+CYc1eV/nfGGShZsXte2a
OGevDNy8ZqG0W/9KpeD60cMLAIwUgfU=
             "]], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{12.82453, 5.289294374999999}, {
             11.960858124999998`, 8.29796625}, {11.080858124999999`, 
             8.29796625}, {12.417186249999999`, 4.337966249999999}, {
             13.193201874999998`, 4.337966249999999}, {14.540701874999998`, 
             8.29796625}, {13.688201874999999`, 8.29796625}, {12.82453, 
             5.289294374999999}}}], 
            FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
             1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
              3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
             0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIpIGYC4qwFP+fsFjB0WFcz7fnBvSIOLFaTza6GGTjM
l3fj6J+h4GC9PHLBXXc9DH7abOnLwlGCDtPNZKaxndfH4Is8/uOrISAD53uI
GTRGxyP4O4KtIv6fR/BbFdhVz8TIOqj9FNyfdEbfIejt5Y8zXiL4h7TunbCJ
koPzweYvkXP4mfT+6PSlBnD7n25Z/mROiSGcr7S/rqPX1AiuHsaHmQfjw+zz
lubzZjYxgrsHxoe5F8aH+QfGn/B91VROQQQfZr/Ei1viF75j8mHh6eiSdevo
cUM4Hz0+AG0eosQ=
             "]]}},
          AspectRatio->1,
          Axes->False,
          Background->GrayLevel[0.93],
          Frame->True,
          FrameStyle->Directive[
            Thickness[Tiny], 
            GrayLevel[0.7]],
          FrameTicks->None,
          ImageSize->{Automatic, 
            Dynamic[
            3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
              Magnification]), ImageSizeCache -> {45., {0., 9.}}]}], 
         GridBox[{
           {
            RowBox[{
             TagBox["\<\"Argument count: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox["1",
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Argument types: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              PaneBox[
               RowBox[{"{", "_Real", "}"}],
               BaselinePosition->Baseline,
               ContentPadding->False,
               FrameMargins->0,
               ImageSize->{{1, 500}, Automatic},
               StripOnInput->True],
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Variables: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              RowBox[{"{", "x", "}"}],
              "SummaryItem"]}]},
           {
            RowBox[{
             TagBox["\<\"Expression: \"\>",
              "SummaryItemAnnotation"], "\[InvisibleSpace]", 
             TagBox[
              PaneBox[
               RowBox[{"Sin", "[", "x", "]"}],
               BaselinePosition->Baseline,
               ContentPadding->False,
               FrameMargins->0,
               ImageSize->{{1, 500}, Automatic},
               StripOnInput->True],
              "SummaryItem"]}]}
          },
          AutoDelete->False,
          
          BaseStyle->{
           ShowStringCharacters -> False, NumberMarks -> False, 
            PrintPrecision -> 3, ShowSyntaxStyles -> False},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}
       },
       AutoDelete->False,
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Rows" -> {{Top}}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
      Typeset`open$$],
      ImageSize->Automatic],
     BaselinePosition->Baseline],
    DynamicModuleValues:>{}], "]"}],
  CompiledFunction[{10, 10.1, 5468}, {
    Blank[Real]}, {{3, 0, 0}, {3, 0, 1}}, {}, {0, 0, 2, 0, 
   0}, {{40, 1, 3, 0, 0, 3, 0, 1}, {1}}, 
   Function[{$CellContext`x}, 
    Sin[$CellContext`x]], Evaluate],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.64285500460968*^9, 3.642855047508301*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sinc", "[", "0.1", "]"}]], "Input",
 CellChangeTimes->{{3.642855031550288*^9, 3.642855033034142*^9}}],

Cell[BoxData["0.09983341664682815`"], "Output",
 CellChangeTimes->{{3.642855033336217*^9, 3.642855048745558*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"sinc", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0.", ",", "Pi"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6428550068481216`*^9, 3.64285501645905*^9}, 
   3.642855089883725*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"CompiledFunction", "::", "cfsa"}], "MessageName"], ":", 
  " ", "\<\"Argument \[NoBreak]\\!\\(x\\)\[NoBreak] at position \[NoBreak]\\!\
\\(1\\)\[NoBreak] should be a \[NoBreak]\\!\\(\\\"machine-size real \
number\\\"\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/CompiledFunction/cfsa\\\", ButtonNote -> \
\\\"CompiledFunction::cfsa\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.642855016891099*^9, 3.642855049804236*^9, 
  3.642855090215457*^9}],

Cell[BoxData["2.000000000000001`"], "Output",
 CellChangeTimes->{3.642855016942998*^9, 3.642855049853581*^9, 
  3.64285509022197*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"theta2", " ", "<", " ", 
      RowBox[{"Pi", "/", "4"}]}], " ", "||", " ", 
     RowBox[{"theta2", " ", ">", " ", 
      RowBox[{
       FractionBox["3", "4"], "Pi"}]}], " ", "||", " ", 
     RowBox[{"theta1", " ", "<", " ", 
      RowBox[{"Pi", "/", "4"}]}], " ", "||", " ", 
     RowBox[{"theta1", " ", ">", " ", 
      RowBox[{
       FractionBox["3", "4"], "Pi"}]}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Element", "[", 
       RowBox[{"theta1", ",", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"phi1", ",", " ", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"gamma1", ",", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"rx", ",", "Reals"}], "]"}], "&&", 
      RowBox[{"Element", "[", 
       RowBox[{"ry", ",", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"rz", ",", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"theta2", ",", "Reals"}], "]"}], "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"phi2", ",", "Reals"}], "]"}], " ", "&&", " ", 
      RowBox[{"Element", "[", 
       RowBox[{"gamma2", ",", "Reals"}], "]"}]}], ","}]}], "*)"}], 
  RowBox[{"AA", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"IntegrandoV1Int", "[", 
        RowBox[{
        "theta1", ",", "phi1", ",", "gamma1", ",", "rx", ",", "ry", ",", "rz",
          ",", "theta2", ",", "phi2", ",", "gamma2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"phi1", ",", " ", "0.0", ",", " ", 
         RowBox[{"2", "Pi"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"phi2", ",", " ", 
         RowBox[{"i", " ", "Pi"}], " ", ",", " ", 
         RowBox[{
          RowBox[{"i", " ", "Pi"}], " ", "+", " ", "Pi"}]}], "}"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"rx", ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SAXALLAT", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "4"}], ",", " ", 
         RowBox[{
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ry", ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SAXALLAT", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "4"}], ",", " ", 
         RowBox[{
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rz", ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SAXALLAT", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "2"}], ",", " ", 
         RowBox[{
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"theta1", ",", "0.0", ",", " ", "Pi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gamma1", ",", "0", ",", 
         RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"theta2", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gamma2", ",", " ", "0", ",", " ", 
         RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<AdaptiveQuasiMonteCarlo\>\"", ",", 
          RowBox[{"\"\<MaxPoints\>\"", "\[Rule]", "5000"}], ",", 
          RowBox[{"\"\<Partitioning\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "1", ",", "3", ",", "3", ",", "3", ",", "3", ",", "1", 
             ",", "3", ",", "1"}], "}"}]}]}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<Partitioning\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "3", ",", "2", ",", "2", ",", "2", ",", "2", ",", "3", ",", "2"}], 
        "}"}]}], "}"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.642784128371687*^9, 3.642784234225184*^9}, {
   3.642850906987885*^9, 3.6428509097645617`*^9}, {3.6428510284002666`*^9, 
   3.64285110565266*^9}, {3.642851137872387*^9, 3.642851198871455*^9}, {
   3.6428532954863853`*^9, 3.642853303801545*^9}, {3.642853345812881*^9, 
   3.6428533478402576`*^9}, {3.642853445158113*^9, 3.642853447814663*^9}, {
   3.642853601946945*^9, 3.64285360230401*^9}, 3.6428536405833073`*^9, {
   3.64285370710643*^9, 3.642853708220783*^9}, {3.6428538650562773`*^9, 
   3.6428538791357203`*^9}, {3.642853935639381*^9, 3.64285396050023*^9}, {
   3.642854007277869*^9, 3.6428540904691153`*^9}, {3.6428541745707903`*^9, 
   3.6428542305619164`*^9}, {3.642854291719203*^9, 3.642854321316763*^9}, {
   3.64285513107802*^9, 3.642855137098804*^9}, {3.642855416689102*^9, 
   3.6428554297493153`*^9}, {3.642855796915041*^9, 3.64285582994983*^9}, {
   3.642866905201127*^9, 3.64286692368757*^9}, {3.642866970803945*^9, 
   3.6428669829086847`*^9}, {3.642867026469647*^9, 3.642867027667737*^9}, {
   3.642867257821281*^9, 3.6428672592682943`*^9}, {3.642867679372163*^9, 
   3.6428676835607147`*^9}, {3.642868064200686*^9, 3.642868075986463*^9}, {
   3.642868117264783*^9, 3.642868142266343*^9}, {3.642868299886112*^9, 
   3.642868328646229*^9}, {3.642868664430512*^9, 3.642868687135523*^9}, {
   3.642869017043859*^9, 3.642869023752962*^9}, {3.642869056298767*^9, 
   3.64286907855385*^9}, {3.6429561029088717`*^9, 3.6429561185130863`*^9}, 
   3.642956213122761*^9, {3.6429562542896957`*^9, 3.642956258401165*^9}, {
   3.642956337671225*^9, 3.642956369823176*^9}, {3.6429564251507683`*^9, 
   3.642956425301961*^9}, {3.642956479119747*^9, 3.64295647931717*^9}, {
   3.642956604941889*^9, 3.642956637051818*^9}, {3.642956783258713*^9, 
   3.642956784345873*^9}, {3.642998227336275*^9, 3.642998234490221*^9}, {
   3.642998528276415*^9, 3.642998535958673*^9}, 3.6429987528666058`*^9, {
   3.642999659076288*^9, 3.642999711260908*^9}, {3.642999841609724*^9, 
   3.6429998616325827`*^9}, {3.64299993110459*^9, 3.642999931503187*^9}, {
   3.643000000647949*^9, 3.643000008782289*^9}, {3.643000462954257*^9, 
   3.643000498157346*^9}, {3.643000780965457*^9, 3.643000786503519*^9}, {
   3.643000887612378*^9, 3.643000893604824*^9}, {3.6430026627317533`*^9, 
   3.643002690203023*^9}, {3.6430039443648167`*^9, 3.643003976966619*^9}, {
   3.6430040639320507`*^9, 3.6430040991677322`*^9}, {3.643005509277368*^9, 
   3.6430055243633327`*^9}, {3.6430056541699677`*^9, 3.643005664888686*^9}, 
   3.643005718419739*^9, {3.6430057606470346`*^9, 3.643005785444276*^9}, {
   3.643007372838751*^9, 3.643007377032559*^9}, {3.6430137712410793`*^9, 
   3.6430137976105957`*^9}, {3.643020046859417*^9, 3.643020173565546*^9}, {
   3.643020396236216*^9, 3.643020410565633*^9}, {3.6430204702282867`*^9, 
   3.643020486391675*^9}, {3.643027140767407*^9, 3.643027141985931*^9}, {
   3.6430272727115602`*^9, 3.6430272957406588`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.6428543100334673`*^9, 3.6428543275904427`*^9}, 
   3.642855181229456*^9, 3.6428552234318438`*^9, 3.642855430543811*^9, 
   3.642855749797778*^9, {3.642855817127678*^9, 3.642855835447092*^9}, 
   3.64286693215315*^9, 3.6428670242107687`*^9, 3.6428672476470127`*^9, 
   3.642867676256257*^9, 3.6428680822910337`*^9, {3.6428681287146673`*^9, 
   3.642868135018633*^9}, 3.64286832487127*^9, 3.642868370000643*^9, 
   3.642868684438908*^9, 3.6428688457492867`*^9, 3.642869086350172*^9, 
   3.64295616626884*^9, 3.642956229872257*^9, {3.6429563331974173`*^9, 
   3.642956361809016*^9}, 3.642956410288073*^9, 3.642956467938787*^9, 
   3.642956596182588*^9, 3.642956787308776*^9, 3.642994656934671*^9, 
   3.642995677732492*^9, 3.642998524300417*^9, 3.64299863792417*^9, 
   3.642999516241846*^9, 3.642999838564795*^9, 3.643000456152989*^9, 
   3.6430004960745163`*^9, {3.643000760070161*^9, 3.643000784122899*^9}, 
   3.643000834334176*^9, {3.643000884666095*^9, 3.643000891666608*^9}, 
   3.643002645342946*^9, 3.643003706364419*^9, 3.643005650037395*^9, 
   3.643006048085763*^9, 3.643007049458933*^9, 3.6430082145517683`*^9, {
   3.643020166293997*^9, 3.643020175303314*^9}, 3.643021110380536*^9, {
   3.6430272638965187`*^9, 3.643027277491667*^9}, 3.643030066218483*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"\"\<Partitioning\>\"", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "3", ",", "3", ",", "3", ",", "3", ",", "1", ",", "3",
      ",", "1"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.643020489202317*^9, 3.643020491225033*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"AA", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "AA", "]"}]}], "}"}]}], "]"}], "/", 
  SuperscriptBox["10", "4"]}]], "Input",
 CellChangeTimes->{{3.6430000124392023`*^9, 3.643000024026359*^9}, {
  3.643000770656885*^9, 3.643000772405548*^9}}],

Cell[BoxData[
 RowBox[{"-", "28731.020981813097`"}]], "Output",
 CellChangeTimes->{{3.643000766214868*^9, 3.643000772691908*^9}, 
   3.643002649869829*^9, 3.643003890216055*^9, 3.6430054825680532`*^9, 
   3.643007362622397*^9, 3.6430137425796137`*^9, 3.643027268502932*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AA", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"IntegrandoV1Int", "[", 
       RowBox[{
       "theta1", ",", "phi1", ",", "gamma1", ",", "rx", ",", "ry", ",", "rz", 
        ",", "theta2", ",", "phi2", ",", "gamma2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"phi1", ",", " ", "0.0", ",", " ", 
        RowBox[{"2", "Pi"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"phi2", ",", " ", 
        RowBox[{"i", " ", "Pi"}], " ", ",", " ", 
        RowBox[{
         RowBox[{"i", " ", "Pi"}], " ", "+", " ", "Pi"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"rx", ",", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "4"}], ",", " ", 
        RowBox[{
         RowBox[{"SAXALLAT", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ry", ",", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "4"}], ",", " ", 
        RowBox[{
         RowBox[{"SAXALLAT", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "4"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"rz", ",", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"SAXALLAT", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "2"}], ",", " ", 
        RowBox[{
         RowBox[{"SAXALLAT", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"theta1", ",", "0.0", ",", " ", "Pi"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"gamma1", ",", "0", ",", 
        RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"theta2", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"gamma2", ",", " ", "0", ",", " ", 
        RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<CartesianRule\>\"", ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<ClenshawCurtisRule\>\"", ",", 
            RowBox[{"\"\<Points\>\"", "\[Rule]", "2"}]}], "}"}]}]}], 
        "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\"\<Partitioning\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "2", ",", "2", ",", "2", ",", "2", ",", "3", ",", "2"}], 
       "}"}]}], "}"}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.64303008025939*^9, 3.6430300852792797`*^9}, {
  3.643030124818993*^9, 3.643030152763156*^9}, {3.64303024630864*^9, 
  3.6430303065554533`*^9}, {3.6430307560562353`*^9, 3.6430307561502447`*^9}, {
  3.643031125094653*^9, 3.643031125220614*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "izero"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Integral and error estimates are 0 on all integration \
subregions. Try increasing the value of the MinRecursion option. If value of \
integral may be 0, specify a finite value for the AccuracyGoal \
option.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.643042337329629*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "izero"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Integral and error estimates are 0 on all integration \
subregions. Try increasing the value of the MinRecursion option. If value of \
integral may be 0, specify a finite value for the AccuracyGoal \
option.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.6430423501782722`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.6430302689025517`*^9, 3.643030753680291*^9, 
  3.643031123252368*^9, 3.643042350233295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox["10", "9"]], "Input",
 CellChangeTimes->{{3.643084515179028*^9, 3.643084517033236*^9}}],

Cell[BoxData["1000000000"], "Output",
 CellChangeTimes->{3.64308451736968*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"3526", "-", "1546"}], ")"}], "*", "45"}]], "Input",
 CellChangeTimes->{{3.643096485121904*^9, 3.643096492222075*^9}, {
  3.6430965856843653`*^9, 3.643096585844757*^9}}],

Cell[BoxData["89100"], "Output",
 CellChangeTimes->{3.6430964925341578`*^9, 3.643096586190592*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"158670", "-", "69570"}]], "Input",
 CellChangeTimes->{{3.6430971018865557`*^9, 3.6430971111989927`*^9}}],

Cell[BoxData["89100"], "Output",
 CellChangeTimes->{3.6430971115121613`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"3526", "*", "44"}]], "Input",
 CellChangeTimes->{{3.643096506723259*^9, 3.64309650886075*^9}}],

Cell[BoxData["155144"], "Output",
 CellChangeTimes->{3.643096509407283*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"110", "^", "3"}]], "Input",
 CellChangeTimes->{{3.643451805082861*^9, 3.643451806295109*^9}, {
  3.6434538406176863`*^9, 3.643453840669704*^9}}],

Cell[BoxData["1331000"], "Output",
 CellChangeTimes->{3.6434518067397738`*^9, 3.643453840873711*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"110.54980000", "/", "2"}]], "Input",
 CellChangeTimes->{{3.6434520397434263`*^9, 3.643452042714634*^9}, {
  3.643453838736615*^9, 3.6434538388044777`*^9}}],

Cell[BoxData["70.2749`"], "Output",
 CellChangeTimes->{3.6434520430078697`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"110.0182966", "/", "2"}]], "Input",
 CellChangeTimes->{{3.64345388053382*^9, 3.6434538815327463`*^9}}],

Cell[BoxData["55.0091483`"], "Output",
 CellChangeTimes->{3.6434538818465242`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "0", "]"}], "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"cospsi", "*", "cosphi"}], "-", 
      RowBox[{"costheta", "*", "sinphi", "*", "sinpsi"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "0", "]"}], "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"cospsi", "*", "sinphi"}], "+", 
      RowBox[{"costheta", "*", "cosphi", "*", "sinpsi"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "0", "]"}], "[", "2", "]"}], "=", 
     RowBox[{"sinpsi", "*", "sintheta"}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "1", "]"}], "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sinpsi"}], "*", "cosphi"}], "-", 
      RowBox[{"costheta", "*", "sinphi", "*", "cospsi"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "1", "]"}], "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sinpsi"}], "*", "sinphi"}], "+", 
      RowBox[{"costheta", "*", "cosphi", "*", "cospsi"}]}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "1", "]"}], "[", "2", "]"}], "=", 
     RowBox[{"cospsi", "*", "sintheta"}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "2", "]"}], "[", "0", "]"}], "=", 
     RowBox[{"sintheta", "*", "sinphi"}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "2", "]"}], "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "sintheta"}], "*", "cosphi"}]}], ";", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"Reul", "[", "2", "]"}], "[", "2", "]"}], "=", "costheta"}], 
    ";"}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1x", "=", 
     RowBox[{"sin", 
      RowBox[{"(", "theta1", ")"}], "*", "cos", 
      RowBox[{"(", "phi1", ")"}]}]}], ";", "\n", 
    RowBox[{"u1y", "=", 
     RowBox[{"sin", 
      RowBox[{"(", "theta1", ")"}], "*", "sin", 
      RowBox[{"(", "phi1", ")"}]}]}], ";", "\n", 
    RowBox[{"u1z", "=", 
     RowBox[{"cos", 
      RowBox[{"(", "theta1", ")"}]}]}], ";", "\n", 
    RowBox[{"u2x", "=", 
     RowBox[{"sin", 
      RowBox[{"(", "theta2", ")"}], "*", "cos", 
      RowBox[{"(", "phi2", ")"}]}]}], ";", "\n", 
    RowBox[{"u2y", "=", 
     RowBox[{"sin", 
      RowBox[{"(", "theta2", ")"}], "*", "sin", 
      RowBox[{"(", "phi2", ")"}]}]}], ";", "\n", 
    RowBox[{"u2z", "=", 
     RowBox[{"cos", 
      RowBox[{"(", "theta2", ")"}]}]}], ";"}], "\n", "*)"}]}]], "Input",
 CellChangeTimes->{{3.643513423985776*^9, 3.643513435667335*^9}, {
  3.643513696223678*^9, 3.643513705304167*^9}, {3.643514381592005*^9, 
  3.643514387487705*^9}}],

Cell[BoxData[
 RowBox[{"Reul", "=."}]], "Input",
 CellChangeTimes->{{3.64351375637638*^9, 3.6435137581240463`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Euler", " ", "Matrix"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.643513772017962*^9, 3.643513776003633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u2", "[", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643514302586582*^9, 3.643514417120616*^9}, {
  3.643515809530623*^9, 3.6435158145606413`*^9}, {3.6436471205142403`*^9, 
  3.643647121678735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u1", "[", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643647126624156*^9, 3.643647142967877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RotationMatrix", "[", 
  RowBox[{
   RowBox[{"-", "\[Phi]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.643519409482307*^9, 3.643519437752922*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6435194287902937`*^9, 3.6435194380078707`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "per", " ", "avere", " ", "u2", " ", "nella", " ", "forma", " ", "sopra", 
     " ", "riportata", " ", "dobbiamo", " ", "usare", " ", "la", " ", 
     "matrice", " ", "di", " ", "Eulero", " ", 
     SubscriptBox["Z", "1"], 
     SubscriptBox["Y", "2"], 
     SubscriptBox["Z", "3"], " ", "e", " ", "non", " ", "quella", " ", "del", 
     " ", "Goldstein", " ", "che", " ", "\[EGrave]", " ", 
     SubscriptBox["Z", "1"], 
     SubscriptBox["X", "2"], 
     SubscriptBox["Z", "3"]}], ",", " ", 
    RowBox[{
     RowBox[{
     "usando", " ", "la", " ", "notazione", " ", "di", " ", "Wikipedia", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "che", " ", "ho", " ", "anche", " ", "usato", " ", "nel", " ", 
          "codice", " ", "Event"}], "-", 
         RowBox[{"Driven", " ", "per", " ", "le", " ", "superquadriche"}]}], 
        ")"}], ".", " ", "Notare"}], " ", "che", " ", "per", " ", 
      "mathematica", "\[IndentingNewLine]", "un", " ", "angolo", " ", 
      "positivo", " ", "\[EGrave]", " ", "clockwise", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "per", " ", "quello", " ", "ho", " ", "messo", " ", "i", " ", "segni",
          " ", "meno"}], ")"}], ".", "\[IndentingNewLine]", "Notare"}], " ", 
      "anche", " ", "che", " ", "se", " ", 
      RowBox[{"x", "'"}], " ", "sono", " ", "le", " ", "coordinate", " ", 
      "del", " ", "riferimento", " ", "del", " ", "corpo", " ", "rigido", " ",
       "e", " ", "x", " ", "quelle", " ", "del", " ", "laboratotio", " ", 
      "si", " ", "ha", "\[IndentingNewLine]", 
      RowBox[{"x", "'"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Reul", "[", 
       RowBox[{"\[Phi]", ",", "\[Theta]", ",", "\[Gamma]"}], "]"}], ".", 
      "x"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6435163838983107`*^9, 3.643516484743428*^9}, {
  3.6435183352843246`*^9, 3.643518421314415*^9}, {3.64351954590994*^9, 
  3.643519581043168*^9}, {3.644207278220581*^9, 3.64420731880875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reul", "[", 
   RowBox[{"\[Phi]_", ",", "\[Theta]_", ",", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"-", "\[Psi]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"-", "\[Theta]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"-", "\[Phi]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6435184296035233`*^9, {3.643518754941669*^9, 3.6435187566316967`*^9}, {
   3.643519163695363*^9, 3.643519218794859*^9}, {3.643519281483087*^9, 
   3.643519295707656*^9}, 3.64351940342981*^9, {3.64351944424197*^9, 
   3.643519446675606*^9}, {3.6435195105573*^9, 3.643519512659711*^9}, {
   3.6435227062259398`*^9, 3.6435227082035017`*^9}, {3.643522862511692*^9, 
   3.643522864320828*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reul", "[", 
  RowBox[{"\[Phi]", ",", "\[Theta]", ",", "\[Gamma]"}], "]"}]], "Input",
 CellChangeTimes->{{3.643518432712782*^9, 3.643518448223968*^9}, {
  3.643518613508979*^9, 3.643518617704267*^9}, {3.643518657444268*^9, 
  3.643518658525326*^9}, {3.643519065554236*^9, 3.643519076317625*^9}, {
  3.6435191234008923`*^9, 3.643519127429997*^9}, {3.643519194630658*^9, 
  3.6435191965197697`*^9}, {3.643601495700255*^9, 3.643601498388592*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.643518449798567*^9, 3.6435186180301332`*^9, 3.6435186588373404`*^9, 
   3.643518760806087*^9, 3.643519077447578*^9, 3.64351912791721*^9, {
   3.643519196840746*^9, 3.643519221588793*^9}, 3.643519298304172*^9, 
   3.643519448748672*^9, 3.643519515497499*^9, 3.643522363120323*^9, 
   3.6435228711260567`*^9, 3.643601444820282*^9, 3.643601498887155*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reul", "[", 
  RowBox[{"0", ",", "0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.6435187262258472`*^9, 3.643518731195341*^9}, {
  3.6436025263233337`*^9, 3.6436025280391617`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6435187315151587`*^9, 3.6435187645090647`*^9, {3.643519498811213*^9, 
   3.643519517188386*^9}, 3.6435223653469563`*^9, 3.6435230185319443`*^9, 
   3.643537430725567*^9, 3.6435918404272842`*^9, 3.6436025283525257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Reul", "[", 
      RowBox[{
       SubscriptBox["\[Alpha]", "1"], ",", 
       SubscriptBox["\[Beta]", "1"], ",", 
       SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
    RowBox[{"u2", "[", 
     RowBox[{
      SubscriptBox["\[Alpha]", "12"], ",", 
      SubscriptBox["\[Beta]", "12"]}], "]"}]}], ")"}], "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6435159560041533`*^9, 3.643515983222341*^9}, {
  3.6435160808675823`*^9, 3.6435160835555363`*^9}, {3.643519628720544*^9, 
  3.6435196315958633`*^9}, {3.643519663980013*^9, 3.643519697941663*^9}, {
  3.64351973356285*^9, 3.6435197378635807`*^9}, {3.6435197764395027`*^9, 
  3.643519809565284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Beta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Alpha]", "12"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Alpha]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.64351596117758*^9, 3.643515983567875*^9}, 
   3.6435160838505077`*^9, {3.64351967151711*^9, 3.643519698626362*^9}, 
   3.643519741528407*^9, {3.643519781437649*^9, 3.643519810119173*^9}, 
   3.643522611128994*^9, 3.643522713224305*^9, 3.6435228783547573`*^9, 
   3.643523011512041*^9, 3.643592497194015*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Reul", "[", 
      RowBox[{
       SubscriptBox["\[Alpha]", "1"], ",", 
       SubscriptBox["\[Beta]", "1"], ",", 
       SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
    RowBox[{"u2", "[", 
     RowBox[{
      SubscriptBox["\[Alpha]", "12"], ",", 
      SubscriptBox["\[Beta]", "12"]}], "]"}]}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6435226371048107`*^9, 3.643522641967614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Alpha]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "1"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Alpha]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}]}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Alpha]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Alpha]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Beta]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Alpha]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Beta]", "12"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Alpha]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Beta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Alpha]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.6435226433433123`*^9, 3.6435227163874693`*^9, 3.643522788765191*^9, 
   3.643522879254613*^9, 3.643523012357033*^9, {3.6435374238465023`*^9, 
   3.6435374428335648`*^9}, 3.643591912824849*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"Reul", "[", 
   RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Psi]"}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.643514464206637*^9, 3.643514476018855*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6435144764328527`*^9, {3.643514515085616*^9, 3.6435145218914433`*^9}, 
   3.643523013836053*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reul", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], ",", 
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
     RowBox[{"u2", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "12"], ",", 
       SubscriptBox["\[Theta]", "12"]}], "]"}]}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.643513780344099*^9, 3.6435137812775908`*^9}, {
   3.643514069399671*^9, 3.643514096475329*^9}, 3.6435141484090767`*^9, {
   3.643514294942524*^9, 3.643514314469206*^9}, {3.6435144201444397`*^9, 
   3.64351442879873*^9}, 3.643514462342268*^9, {3.643514606373262*^9, 
   3.6435146765282784`*^9}, {3.643514781834753*^9, 3.643514783625696*^9}, {
   3.643515776061739*^9, 3.64351582611994*^9}, {3.643522246946435*^9, 
   3.6435223001249123`*^9}, {3.643522347604063*^9, 3.643522357006523*^9}, 
   3.643523193115449*^9, {3.6435373792415047`*^9, 3.6435373793732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}]}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "12"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.643514431918977*^9, 3.643514454432016*^9}, {
   3.643514517748685*^9, 3.643514523603463*^9}, {3.643514609135714*^9, 
   3.643514676970571*^9}, 3.643514784107297*^9, {3.643515798820109*^9, 
   3.643515826460556*^9}, 3.643515886367621*^9, 3.6435196222068243`*^9, {
   3.643522243842051*^9, 3.643522300720026*^9}, {3.643522357811153*^9, 
   3.643522381839326*^9}, 3.6435231016528482`*^9, 3.64352319360816*^9, 
   3.643537380486904*^9, 3.6435918508169117`*^9, 3.643591902201687*^9, 
   3.643591973675003*^9, 3.643647356835215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reul", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], ",", 
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.643647155682343*^9, 3.643647157601452*^9}, {
  3.6436473996785603`*^9, 3.643647406019456*^9}, {3.6436474852993927`*^9, 
  3.643647498698123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   SubscriptBox["\[Phi]", "1"], "]"}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["\[Theta]", "1"], "]"}]}]], "Output",
 CellChangeTimes->{
  3.643647159506234*^9, {3.643647400277689*^9, 3.6436474062930193`*^9}, 
   3.643647498963862*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reul", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], ",", 
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.6436275596704397`*^9, 3.6436275724239197`*^9}, {
  3.643647510173729*^9, 3.643647512617297*^9}, {3.643647554452126*^9, 
  3.64364755787292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   SubscriptBox["\[Phi]", "1"], "]"}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["\[Theta]", "1"], "]"}]}]], "Output",
 CellChangeTimes->{
  3.643627572722172*^9, 3.643647513067107*^9, {3.643647555186174*^9, 
   3.6436475582023087`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reul", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], ",", 
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ")"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.643645771049192*^9, 3.643645780847205*^9}}],

Cell[BoxData[
 RowBox[{"Cos", "[", 
  SubscriptBox["\[Theta]", "1"], "]"}]], "Output",
 CellChangeTimes->{{3.643645772863368*^9, 3.64364578117104*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X1", "[", 
     RowBox[{
     "\[Phi]1_", ",", "\[Theta]1_", ",", "\[Gamma]1_", ",", "\[Phi]12_", ",", 
      "\[Theta]12_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]12", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", 
           RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], " ", ")"}], "  ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]12", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]12", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], ")"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.643537496705536*^9, 3.64353749706007*^9}, {
   3.643597281257526*^9, 3.643597477442326*^9}, {3.643597511359688*^9, 
   3.643597692028054*^9}, {3.643597845904511*^9, 3.643597906355412*^9}, {
   3.643597937227664*^9, 3.6435979825354767`*^9}, {3.643627519496944*^9, 
   3.643627539814768*^9}, 3.643627911887869*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}]}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.643597948145322*^9, 3.6435979759772587`*^9}, 
   3.643627535528113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["10", "3"], 
   RowBox[{"32", " ", 
    SuperscriptBox["Pi", "3"], 
    SuperscriptBox[
     RowBox[{"Sinh", "[", "10", "]"}], "2"]}]], 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"X1", "[", 
     RowBox[{
     "\[Phi]", ",", "\[Theta]", ",", "\[Gamma]", ",", "0.423915935910026", 
      ",", "0.0409875291585542", ",", "10"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", " ", 
      RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", " ", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]", ",", "0", ",", " ", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"Method", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<GaussKronrodRule\>\"", ",", " ", 
       RowBox[{"\"\<Points\>\"", "\[Rule]", "40"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.643597992823207*^9, 3.643597993286075*^9}, {
  3.643598084813451*^9, 3.643598130729447*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.000650175933169438`"}]], "Output",
 CellChangeTimes->{{3.643597988242091*^9, 3.643597994129162*^9}, {
  3.643598108284451*^9, 3.643598133868813*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"X2", "[", 
    RowBox[{
    "\[Phi]1_", ",", "\[Theta]1_", ",", "\[Gamma]1_", ",", "\[Phi]12_", ",", 
     "\[Theta]12_", ",", "\[Alpha]_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]12", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", 
          RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Gamma]1", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], " ", ")"}], "  ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]12", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]12", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], ")"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.643598158204454*^9, 3.643598172334469*^9}, {
  3.643598203237096*^9, 3.643598230517659*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["10", "3"], 
   RowBox[{"32", " ", 
    SuperscriptBox["Pi", "3"], 
    SuperscriptBox[
     RowBox[{"Sinh", "[", "10", "]"}], "2"]}]], 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"X2", "[", 
     RowBox[{
     "\[Phi]", ",", "\[Theta]", ",", "\[Gamma]", ",", "0.423915935910026", 
      ",", "0.0409875291585542", ",", "10"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", " ", 
      RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", " ", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]", ",", "0", ",", " ", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"Method", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<GaussKronrodRule\>\"", ",", " ", 
       RowBox[{"\"\<Points\>\"", "\[Rule]", "40"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6435982417147207`*^9, 3.6435982483762693`*^9}}],

Cell[BoxData["0.00144074472345724`"], "Output",
 CellChangeTimes->{3.6435982514161997`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"X3", "[", 
   RowBox[{
   "\[Phi]1_", ",", "\[Theta]1_", ",", "\[Gamma]1_", ",", "\[Phi]12_", ",", 
    "\[Theta]12_", ",", "\[Alpha]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]12", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", 
         RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Gamma]1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], " ", ")"}], "  ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}], " ", 
   RowBox[{"Sinh", "[", 
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]12", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]12", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]12", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Gamma]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]12", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]12", "]"}]}]}], ")"}]}], "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.64359844095261*^9, 3.643598462878504*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["10", "3"], 
   RowBox[{"32", " ", 
    SuperscriptBox["Pi", "3"], 
    SuperscriptBox[
     RowBox[{"Sinh", "[", "10", "]"}], "2"]}]], 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"X3", "[", 
     RowBox[{
     "\[Phi]", ",", "\[Theta]", ",", "\[Gamma]", ",", "0.423915935910026", 
      ",", "0.0409875291585542", ",", "10"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", " ", 
      RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", " ", "Pi"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]", ",", "0", ",", " ", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"Method", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<GaussKronrodRule\>\"", ",", " ", 
       RowBox[{"\"\<Points\>\"", "\[Rule]", "10"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6435984757963963`*^9, 3.6435984758781433`*^9}, {
  3.643598507199421*^9, 3.643598507245454*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.64359852751022*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.643598504117449*^9, 3.643598597077366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X1", "[", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "10"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6435975471244907`*^9, 3.6435975579223623`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6435975547901697`*^9, 3.6435975581687813`*^9}, 
   3.6435976609573793`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Reul", "[", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], ",", 
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
     RowBox[{"u2", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "12"], ",", 
       SubscriptBox["\[Theta]", "12"]}], "]"}]}], ")"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.643537483061227*^9, 3.643537483120619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "12"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "12"], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.6435374834010897`*^9, 3.643538017369979*^9, {3.6435918868979053`*^9, 
   3.643591905162554*^9}, 3.6435924835278797`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.643513537671517*^9, 3.643513540316638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Reul", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], ",", 
          SubscriptBox["\[Theta]", "1"], ",", 
          SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}]}], ")"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "]"}]], "Input",
 CellChangeTimes->{{3.6435149475928183`*^9, 3.643514964405758*^9}, {
  3.6435199031076612`*^9, 3.643519934462913*^9}, {3.6435376618794107`*^9, 
  3.643537668515678*^9}, {3.643546280543181*^9, 3.643546282645137*^9}, {
  3.643628399465084*^9, 3.643628417294652*^9}, {3.643631028632526*^9, 
  3.643631070804949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["ry", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "rx", " ", "ry", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["rx", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "rx", " ", "ry", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["rx", "2"], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["ry", "2"], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
  RowBox[{"2", " ", "rx", " ", "ry", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
  RowBox[{"2", " ", "rx", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["rx", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "rx", " ", "ry", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["ry", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "rx", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["rz", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.643646362239462*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.643631146030491*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"XI1_v2", "=", 
   RowBox[{
    SuperscriptBox["rx", "2"], " ", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Gamma]", "1"], "]"}], "2"]}], "+", 
      RowBox[{"2", "  ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}]}], "+", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], " ", ")"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.643631147387495*^9, {3.643631254617889*^9, 3.643631291056344*^9}, {
   3.6436313498791237`*^9, 3.643631366284689*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["rx", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6436313547608843`*^9, 3.643631366589259*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"XI2_v2", " ", "=", " ", 
  RowBox[{
   SuperscriptBox["ry", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], "+", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6436313585333643`*^9, 3.6436314220592813`*^9}}],

Cell[BoxData[
 RowBox[{"XI3_v2", "=", " ", 
  RowBox[{
   SuperscriptBox["rz", 
    RowBox[{"2", " "}]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.643631566345339*^9, 3.643631571583568*^9}, {
  3.643631614883421*^9, 3.6436316200782547`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"XI4_v2", " ", "=", 
  RowBox[{"rx", " ", "ry", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}]}], "+", 
     RowBox[{"2", "  ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], " ", "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], "-", "\[IndentingNewLine]", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.643646897749687*^9, 3.643646898069295*^9}}],

Cell[BoxData[
 RowBox[{"rx", " ", "ry", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6436468989912357`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"XI5_v2", "=", " ", 
  RowBox[{"2", " ", "rx", " ", "rz", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
     RowBox[{"2", "  ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6436319080300303`*^9, 3.643631955153051*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "rx", " ", "rz", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6436319692920647`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.643631920731666*^9, 3.64363192075412*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"XI6_v2", "=", " ", 
   RowBox[{
    RowBox[{"2", " ", "ry", " ", "rz", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
    RowBox[{"2", " ", "ry", " ", "rz", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.643631148384495*^9, 3.643631162821209*^9}, {
  3.643631252292553*^9, 3.6436312941028233`*^9}, {3.6436313807355747`*^9, 
  3.6436314152126904`*^9}, {3.643631555043791*^9, 3.643631612716028*^9}, {
  3.6436317027896967`*^9, 3.643631763048644*^9}, {3.643631933510089*^9, 
  3.6436319648488817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.643631755665145*^9, 3.643631965722453*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "[", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Reul", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], ",", 
           SubscriptBox["\[Theta]", "1"], ",", 
           SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["rx", "2"], "\[Rule]", "0"}], " ", ",", " ", 
    RowBox[{
     SuperscriptBox["ry", "2"], "\[Rule]", " ", "0"}], ",", " ", 
    RowBox[{
     SuperscriptBox["rz", "2"], "\[Rule]", "0"}], ",", 
    RowBox[{"rx", "\[Rule]", "0"}]}], " ", "}"}]}]], "Input",
 CellChangeTimes->{{3.643631981639138*^9, 3.6436320194854183`*^9}, {
  3.643633250525202*^9, 3.643633314465455*^9}, {3.6436333592586946`*^9, 
  3.643633380702591*^9}, {3.643646711657999*^9, 3.643646711836713*^9}, {
  3.6436467458256397`*^9, 3.643646769764208*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}]}], "-", 
  RowBox[{"2", " ", "ry", " ", "rz", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Gamma]", "1"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.643631997108696*^9, 3.643632019914847*^9}, {
   3.6436332511666183`*^9, 3.64363331473742*^9}, {3.643633360019302*^9, 
   3.643633381089821*^9}, 3.643646712242934*^9, {3.643646746444894*^9, 
   3.643646770164262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "[", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Reul", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], ",", 
           SubscriptBox["\[Theta]", "1"], ",", 
           SubscriptBox["\[Gamma]", "1"]}], "]"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rx", "\[Rule]", " ", "0"}], ",", " ", 
    RowBox[{"ry", "\[Rule]", " ", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.643646614310965*^9, 3.643646667963196*^9}, {
  3.6436466996245413`*^9, 3.6436466997742367`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["rz", "2"], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "1"], "]"}], "2"], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "1"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.643646626984363*^9, 3.643646636699436*^9}, 
   3.643646668378668*^9, 3.643646700246986*^9}]
}, Open  ]]
},
WindowSize->{1437, 892},
WindowMargins->{{434, Automatic}, {Automatic, 42}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 263, 4, 35, "Input"],
Cell[824, 26, 68, 1, 35, "Input"],
Cell[895, 29, 189, 4, 35, "Input"],
Cell[1087, 35, 8169, 200, 708, "Input"],
Cell[CellGroupData[{
Cell[9281, 239, 724, 12, 57, "Input"],
Cell[10008, 253, 290, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10335, 264, 82, 2, 35, "Input"],
Cell[10420, 268, 206, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10663, 278, 1930, 50, 120, "Input"],
Cell[12596, 330, 840, 13, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13473, 348, 1570, 43, 120, "Input"],
Cell[15046, 393, 342, 5, 35, "Output"]
}, Open  ]],
Cell[15403, 401, 193, 3, 35, "Input"],
Cell[15599, 406, 37677, 923, 2850, "Input"],
Cell[53279, 1331, 459, 12, 97, "Input"],
Cell[53741, 1345, 4302, 110, 465, "Input"],
Cell[58046, 1457, 3426, 97, 438, "Input"],
Cell[CellGroupData[{
Cell[61497, 1558, 236, 5, 45, "Input"],
Cell[61736, 1565, 344, 9, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62117, 1579, 148, 3, 43, "Input"],
Cell[62268, 1584, 234, 6, 43, "Output"]
}, Open  ]],
Cell[62517, 1593, 470, 15, 36, "Input"],
Cell[62990, 1610, 5698, 145, 288, "Input"],
Cell[CellGroupData[{
Cell[68713, 1759, 554, 15, 35, "Input"],
Cell[69270, 1776, 541, 15, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69848, 1796, 148, 3, 35, "Input"],
Cell[69999, 1801, 248, 5, 35, "Output"]
}, Open  ]],
Cell[70262, 1809, 92, 1, 35, "Input"],
Cell[70357, 1812, 6719, 158, 540, "Input"],
Cell[CellGroupData[{
Cell[77101, 1974, 1959, 49, 141, "Input"],
Cell[79063, 2025, 188, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79288, 2034, 211, 4, 36, "Input"],
Cell[79502, 2040, 117, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79656, 2047, 150, 3, 35, "Input"],
Cell[79809, 2052, 278, 6, 35, "Output"]
}, Open  ]],
Cell[80102, 2061, 3263, 80, 246, "Input"],
Cell[CellGroupData[{
Cell[83390, 2145, 161, 3, 35, "Input"],
Cell[83554, 2150, 405, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83996, 2164, 102, 1, 35, "Input"],
Cell[84101, 2167, 144, 3, 35, "Output"]
}, Open  ]],
Cell[84260, 2173, 1155, 33, 135, "Input"],
Cell[85418, 2208, 5250, 122, 393, "Input"],
Cell[90671, 2332, 191, 4, 53, "Input"],
Cell[90865, 2338, 1010, 24, 121, "Input"],
Cell[CellGroupData[{
Cell[91900, 2366, 254, 5, 53, "Input"],
Cell[92157, 2373, 206, 3, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92400, 2381, 849, 16, 56, "Input"],
Cell[93252, 2399, 77, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93366, 2405, 124, 2, 53, "Input"],
Cell[93493, 2409, 114, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93644, 2415, 297, 6, 56, "Input"],
Cell[93944, 2423, 132, 2, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94113, 2430, 341, 9, 36, "Input"],
Cell[94457, 2441, 13660, 296, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108154, 2742, 125, 2, 35, "Input"],
Cell[108282, 2746, 113, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108432, 2752, 272, 7, 36, "Input"],
Cell[108707, 2761, 602, 11, 29, "Message"],
Cell[109312, 2774, 133, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109482, 2781, 7186, 152, 193, "Input"],
Cell[116671, 2935, 1325, 18, 35, "Output"]
}, Open  ]],
Cell[118011, 2956, 300, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[118336, 2967, 401, 11, 42, "Input"],
Cell[118740, 2980, 273, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119050, 2989, 2940, 77, 120, "Input"],
Cell[121993, 3068, 423, 10, 49, "Message"],
Cell[122419, 3080, 425, 10, 49, "Message"],
Cell[122847, 3092, 190, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123074, 3101, 117, 2, 38, "Input"],
Cell[123194, 3105, 78, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123309, 3111, 220, 5, 35, "Input"],
Cell[123532, 3118, 98, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123667, 3124, 128, 2, 35, "Input"],
Cell[123798, 3128, 76, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123911, 3134, 118, 2, 35, "Input"],
Cell[124032, 3138, 75, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124144, 3144, 168, 3, 35, "Input"],
Cell[124315, 3149, 100, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124452, 3155, 179, 3, 35, "Input"],
Cell[124634, 3160, 79, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124750, 3166, 126, 2, 35, "Input"],
Cell[124879, 3170, 82, 1, 35, "Output"]
}, Open  ]],
Cell[124976, 3174, 2789, 77, 414, "Input"],
Cell[127768, 3253, 115, 2, 35, "Input"],
Cell[127886, 3257, 159, 3, 35, "Input"],
Cell[128048, 3262, 606, 16, 36, "Input"],
Cell[128657, 3280, 504, 14, 36, "Input"],
Cell[CellGroupData[{
Cell[129186, 3298, 239, 6, 35, "Input"],
Cell[129428, 3306, 504, 14, 35, "Output"]
}, Open  ]],
Cell[129947, 3323, 2133, 46, 162, "Input"],
Cell[132083, 3371, 1056, 26, 36, "Input"],
Cell[CellGroupData[{
Cell[133164, 3401, 467, 7, 35, "Input"],
Cell[133634, 3410, 2335, 61, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136006, 3476, 211, 4, 35, "Input"],
Cell[136220, 3482, 503, 12, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136760, 3499, 777, 19, 36, "Input"],
Cell[137540, 3520, 1118, 29, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138695, 3554, 526, 15, 36, "Input"],
Cell[139224, 3571, 1735, 51, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140996, 3627, 212, 5, 36, "Input"],
Cell[141211, 3634, 2062, 58, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143310, 3697, 1092, 23, 57, "Input"],
Cell[144405, 3722, 2059, 55, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146501, 3782, 591, 16, 36, "Input"],
Cell[147095, 3800, 287, 8, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147419, 3813, 590, 16, 36, "Input"],
Cell[148012, 3831, 287, 8, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148336, 3844, 489, 14, 36, "Input"],
Cell[148828, 3860, 151, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149016, 3868, 3213, 76, 204, "Input"],
Cell[152232, 3946, 1599, 49, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153868, 4000, 1011, 28, 92, "Input"],
Cell[154882, 4030, 180, 3, 35, "Output"]
}, Open  ]],
Cell[155077, 4036, 2870, 72, 162, "Input"],
Cell[CellGroupData[{
Cell[157972, 4112, 966, 27, 92, "Input"],
Cell[158941, 4141, 91, 1, 35, "Output"]
}, Open  ]],
Cell[159047, 4145, 2483, 62, 120, "Input"],
Cell[CellGroupData[{
Cell[161555, 4211, 1015, 28, 92, "Input"],
Cell[162573, 4241, 577, 11, 29, "Message"],
Cell[163153, 4254, 99, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163289, 4260, 192, 4, 35, "Input"],
Cell[163484, 4266, 126, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163647, 4273, 553, 16, 36, "Input"],
Cell[164203, 4291, 935, 27, 35, "Output"]
}, Open  ]],
Cell[165153, 4321, 92, 1, 35, "Input"],
Cell[CellGroupData[{
Cell[165270, 4326, 827, 20, 42, "Input"],
Cell[166100, 4348, 5082, 149, 135, "Output"]
}, Open  ]],
Cell[171197, 4500, 87, 1, 57, "Input"],
Cell[CellGroupData[{
Cell[171309, 4505, 1342, 38, 63, "Input"],
Cell[172654, 4545, 1122, 33, 42, "Output"]
}, Open  ]],
Cell[173791, 4581, 1192, 34, 42, "Input"],
Cell[174986, 4617, 431, 12, 39, "Input"],
Cell[CellGroupData[{
Cell[175442, 4633, 1630, 44, 70, "Input"],
Cell[177075, 4679, 1506, 43, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178618, 4727, 892, 24, 42, "Input"],
Cell[179513, 4753, 814, 23, 42, "Output"]
}, Open  ]],
Cell[180342, 4779, 91, 1, 35, "Input"],
Cell[180436, 4782, 1165, 27, 81, "Input"],
Cell[181604, 4811, 781, 21, 39, "Output"],
Cell[CellGroupData[{
Cell[182410, 4836, 1117, 29, 42, "Input"],
Cell[183530, 4867, 956, 24, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184523, 4896, 796, 22, 42, "Input"],
Cell[185322, 4920, 369, 10, 39, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
